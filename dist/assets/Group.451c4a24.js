var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,a=(e,a)=>{for(var r in a||(a={}))o.call(a,r)&&d(e,r,a[r]);if(t)for(var r of t(a))n.call(a,r)&&d(e,r,a[r]);return e};import{d as r,a8 as s,e as i,f as l,g as c,b5 as h,b as u,y as p,G as f,p as g,r as y,bg as m,be as k,bi as v,E as N,aJ as C,n as x,F as b,M as D,bj as E,aG as w,c as K,W as _,ag as S,X as O,w as A,aA as T,x as B,ah as L,Q as $,h as I,O as j,H as M,aw as q,aj as z,o as P,b8 as V,C as F,b6 as R,B as H,ao as U,ai as J,s as W,P as G,i as Q,k as X,m as Y,l as Z}from"./index.b6704809.js";import{e as ee,g as te,E as oe,b as ne,c as de,f as ae,u as re,h as se,i as ie,j as le}from"./el-notification.4cc355f2.js";/* empty css                       */import{E as ce,a as he}from"./el-form-item.781d531d.js";/* empty css                 */const ue=r({name:"CaretRight"}),pe={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},fe=[c("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null,-1)];var ge=s(ue,[["render",function(e,t,o,n,d,a){return i(),l("svg",pe,fe)}]]);const ye="$treeNodeId",me=function(e,t){t&&!t[ye]&&Object.defineProperty(t,ye,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},ke=function(e,t){return e?t[e]:t[ye]},ve=e=>{let t=!0,o=!0,n=!0;for(let d=0,a=e.length;d<a;d++){const a=e[d];(!0!==a.checked||a.indeterminate)&&(t=!1,a.disabled||(n=!1)),(!1!==a.checked||a.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:n,half:!t&&!o}},Ne=function(e){if(0===e.childNodes.length)return;const{all:t,none:o,half:n}=ve(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):n?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;d&&0!==d.level&&(e.store.checkStrictly||Ne(d))},Ce=function(e,t){const o=e.store.props,n=e.data||{},d=o[t];if("function"==typeof d)return d(n,e);if("string"==typeof d)return n[d];if(void 0===d){const e=n[t];return void 0===e?"":e}};let xe=0;class be{constructor(e){this.id=xe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const t in e)h(e,t)&&(this[t]=e[t]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const e=this.store;if(!e)throw new Error("[Node]store is required!");e.registerNode(this);const t=e.props;if(t&&void 0!==t.isLeaf){const e=Ce(this,"isLeaf");"boolean"==typeof e&&(this.isLeafByUser=e)}if(!0!==e.lazy&&this.data?(this.setData(this.data),e.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&e.lazy&&e.defaultExpandAll&&this.expand(),Array.isArray(this.data)||me(this,this.data),!this.data)return;const o=e.defaultExpandedKeys,n=e.key;n&&o&&-1!==o.indexOf(this.key)&&this.expand(null,e.autoExpandParent),n&&void 0!==e.currentNodeKey&&this.key===e.currentNodeKey&&(e.currentNode=this,e.currentNode.isCurrent=!0),e.lazy&&e._initDefaultCheckedNode(this),this.updateLeafState(),!this.parent||1!==this.level&&!0!==this.parent.expanded||(this.canFocus=!0)}setData(e){let t;Array.isArray(e)||me(this,e),this.data=e,this.childNodes=[],t=0===this.level&&this.data instanceof Array?this.data:Ce(this,"children")||[];for(let o=0,n=t.length;o<n;o++)this.insertChild({data:t[o]})}get label(){return Ce(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return Ce(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}get previousSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}contains(e,t=!0){return(this.childNodes||[]).some((o=>o===e||t&&o.contains(e)))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,t,o){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof be)){if(!o){const o=this.getChildren(!0);-1===o.indexOf(e.data)&&(void 0===t||t<0?o.push(e.data):o.splice(t,0,e.data))}Object.assign(e,{parent:this,store:this.store}),(e=u(new be(e)))instanceof be&&e.initialize()}e.level=this.level+1,void 0===t||t<0?this.childNodes.push(e):this.childNodes.splice(t,0,e),this.updateLeafState()}insertBefore(e,t){let o;t&&(o=this.childNodes.indexOf(t)),this.insertChild(e,o)}insertAfter(e,t){let o;t&&(o=this.childNodes.indexOf(t),-1!==o&&(o+=1)),this.insertChild(e,o)}removeChild(e){const t=this.getChildren()||[],o=t.indexOf(e.data);o>-1&&t.splice(o,1);const n=this.childNodes.indexOf(e);n>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(e){let t=null;for(let o=0;o<this.childNodes.length;o++)if(this.childNodes[o].data===e){t=this.childNodes[o];break}t&&this.removeChild(t)}expand(e,t){const o=()=>{if(t){let e=this.parent;for(;e.level>0;)e.expanded=!0,e=e.parent}this.expanded=!0,e&&e(),this.childNodes.forEach((e=>{e.canFocus=!0}))};this.shouldLoadData()?this.loadData((e=>{Array.isArray(e)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Ne(this),o())})):o()}doCreateChildren(e,t={}){e.forEach((e=>{this.insertChild(Object.assign({data:e},t),void 0,!0)}))}collapse(){this.expanded=!1,this.childNodes.forEach((e=>{e.canFocus=!1}))}shouldLoadData(){return!0===this.store.lazy&&this.store.load&&!this.loaded}updateLeafState(){if(!0===this.store.lazy&&!0!==this.loaded&&void 0!==this.isLeafByUser)return void(this.isLeaf=this.isLeafByUser);const e=this.childNodes;!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1}setChecked(e,t,o,n){if(this.indeterminate="half"===e,this.checked=!0===e,this.store.checkStrictly)return;if(!this.shouldLoadData()||this.store.checkDescendants){const{all:o,allWithoutDisable:d}=ve(this.childNodes);this.isLeaf||o||!d||(this.checked=!1,e=!1);const a=()=>{if(t){const o=this.childNodes;for(let r=0,s=o.length;r<s;r++){const d=o[r];n=n||!1!==e;const a=d.disabled?d.checked:n;d.setChecked(a,t,!0,n)}const{half:d,all:a}=ve(o);a||(this.checked=a,this.indeterminate=d)}};if(this.shouldLoadData())return void this.loadData((()=>{a(),Ne(this)}),{checked:!1!==e});a()}const d=this.parent;d&&0!==d.level&&(o||Ne(d))}getChildren(e=!1){if(0===this.level)return this.data;const t=this.data;if(!t)return null;const o=this.store.props;let n="children";return o&&(n=o.children||"children"),void 0===t[n]&&(t[n]=null),e&&!t[n]&&(t[n]=[]),t[n]}updateChildren(){const e=this.getChildren()||[],t=this.childNodes.map((e=>e.data)),o={},n=[];e.forEach(((e,d)=>{const a=e[ye];!!a&&t.findIndex((e=>e[ye]===a))>=0?o[a]={index:d,data:e}:n.push({index:d,data:e})})),this.store.lazy||t.forEach((e=>{o[e[ye]]||this.removeChildByData(e)})),n.forEach((({index:e,data:t})=>{this.insertChild({data:t},e)})),this.updateLeafState()}loadData(e,t={}){if(!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!Object.keys(t).length)e&&e.call(this);else{this.loading=!0;const o=o=>{this.loaded=!0,this.loading=!1,this.childNodes=[],this.doCreateChildren(o,t),this.updateLeafState(),e&&e.call(this,o)};this.store.load(this,o)}}}class De{constructor(e){this.currentNode=null,this.currentNodeKey=null;for(const t in e)h(e,t)&&(this[t]=e[t]);this.nodesMap={}}initialize(){if(this.root=new be({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){(0,this.load)(this.root,(e=>{this.root.doCreateChildren(e),this._initDefaultCheckedNodes()}))}else this._initDefaultCheckedNodes()}filter(e){const t=this.filterNodeMethod,o=this.lazy,n=function(d){const a=d.root?d.root.childNodes:d.childNodes;if(a.forEach((o=>{o.visible=t.call(o,e,o.data,o),n(o)})),!d.visible&&a.length){let e=!0;e=!a.some((e=>e.visible)),d.root?d.root.visible=!1===e:d.visible=!1===e}e&&(!d.visible||d.isLeaf||o||d.expand())};n(this)}setData(e){e!==this.root.data?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(e){if(e instanceof be)return e;const t="object"!=typeof e?e:ke(this.key,e);return this.nodesMap[t]||null}insertBefore(e,t){const o=this.getNode(t);o.parent.insertBefore({data:e},o)}insertAfter(e,t){const o=this.getNode(t);o.parent.insertAfter({data:e},o)}remove(e){const t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))}append(e,t){const o=t?this.getNode(t):this.root;o&&o.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],t=this.nodesMap;e.forEach((e=>{const o=t[e];o&&o.setChecked(!0,!this.checkStrictly)}))}_initDefaultCheckedNode(e){-1!==(this.defaultCheckedKeys||[]).indexOf(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const t=this.key;if(e&&e.data)if(t){void 0!==e.key&&(this.nodesMap[e.key]=e)}else this.nodesMap[e.id]=e}deregisterNode(e){this.key&&e&&e.data&&(e.childNodes.forEach((e=>{this.deregisterNode(e)})),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,t=!1){const o=[],n=function(d){(d.root?d.root.childNodes:d.childNodes).forEach((d=>{(d.checked||t&&d.indeterminate)&&(!e||e&&d.isLeaf)&&o.push(d.data),n(d)}))};return n(this),o}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map((e=>(e||{})[this.key]))}getHalfCheckedNodes(){const e=[],t=function(o){(o.root?o.root.childNodes:o.childNodes).forEach((o=>{o.indeterminate&&e.push(o.data),t(o)}))};return t(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map((e=>(e||{})[this.key]))}_getAllNodes(){const e=[],t=this.nodesMap;for(const o in t)h(t,o)&&e.push(t[o]);return e}updateChildren(e,t){const o=this.nodesMap[e];if(!o)return;const n=o.childNodes;for(let d=n.length-1;d>=0;d--){const e=n[d];this.remove(e.data)}for(let d=0,a=t.length;d<a;d++){const e=t[d];this.append(e,o.data)}}_setCheckedKeys(e,t=!1,o){const n=this._getAllNodes().sort(((e,t)=>t.level-e.level)),d=Object.create(null),a=Object.keys(o);n.forEach((e=>e.setChecked(!1,!1)));for(let r=0,s=n.length;r<s;r++){const o=n[r],s=o.data[e].toString();if(!(a.indexOf(s)>-1)){o.checked&&!d[s]&&o.setChecked(!1,!1);continue}let i=o.parent;for(;i&&i.level>0;)d[i.data[e]]=!0,i=i.parent;if(o.isLeaf||this.checkStrictly)o.setChecked(!0,!1);else if(o.setChecked(!0,!0),t){o.setChecked(!1,!1);const e=function(t){t.childNodes.forEach((t=>{t.isLeaf||t.setChecked(!1,!1),e(t)}))};e(o)}}}setCheckedNodes(e,t=!1){const o=this.key,n={};e.forEach((e=>{n[(e||{})[o]]=!0})),this._setCheckedKeys(o,t,n)}setCheckedKeys(e,t=!1){this.defaultCheckedKeys=e;const o=this.key,n={};e.forEach((e=>{n[e]=!0})),this._setCheckedKeys(o,t,n)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach((e=>{const t=this.getNode(e);t&&t.expand(null,this.autoExpandParent)}))}setChecked(e,t,o){const n=this.getNode(e);n&&n.setChecked(!!t,o)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,t=!0){const o=e[this.key],n=this.nodesMap[o];this.setCurrentNode(n),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(e,t=!0){if(null==e)return this.currentNode&&(this.currentNode.isCurrent=!1),void(this.currentNode=null);const o=this.getNode(e);o&&(this.setCurrentNode(o),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}var Ee=r({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=p("NodeInstance"),o=p("RootTree");return()=>{const n=e.node,{data:d,store:a}=n;return e.renderContent?e.renderContent(f,{_self:t,node:n,data:d,store:a}):o.ctx.slots.default?o.ctx.slots.default({node:n,data:d}):f("span",{class:"el-tree-node__label"},[n.label])}}});function we(e){const t=p("TreeNodeMap",null),o={treeNodeExpand:t=>{e.node!==t&&e.node.collapse()},children:[]};return t&&t.children.push(o),g("TreeNodeMap",o),{broadcastExpanded:t=>{if(e.accordion)for(const e of o.children)e.treeNodeExpand(t)}}}Ee.__file="packages/components/tree/src/tree-node-content.vue";const Ke=Symbol("dragEvents");var _e=r({name:"ElTreeNode",components:{ElCollapseTransition:v,ElCheckbox:ee,NodeContent:Ee,ElIcon:N,Loading:C},props:{node:{type:be,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const{broadcastExpanded:o}=we(e),n=p("RootTree"),d=y(!1),a=y(!1),r=y(null),s=y(null),i=y(null),l=p(Ke),c=D();g("NodeInstance",c),e.node.expanded&&(d.value=!0,a.value=!0);const h=n.props.children||"children";x((()=>{const t=e.node.data[h];return t&&[...t]}),(()=>{e.node.updateChildren()})),x((()=>e.node.indeterminate),(t=>{u(e.node.checked,t)})),x((()=>e.node.checked),(t=>{u(t,e.node.indeterminate)})),x((()=>e.node.expanded),(e=>{b((()=>d.value=e)),e&&(a.value=!0)}));const u=(t,o)=>{r.value===t&&s.value===o||n.ctx.emit("check-change",e.node.data,t,o),r.value=t,s.value=o},f=()=>{e.node.isLeaf||(d.value?(n.ctx.emit("node-collapse",e.node.data,e.node,c),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,c)))},m=(t,o)=>{e.node.setChecked(o.target.checked,!n.props.checkStrictly),b((()=>{const t=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:t.getCheckedNodes(),checkedKeys:t.getCheckedKeys(),halfCheckedNodes:t.getHalfCheckedNodes(),halfCheckedKeys:t.getHalfCheckedKeys()})}))};return{node$:i,tree:n,expanded:d,childNodeRendered:a,oldChecked:r,oldIndeterminate:s,getNodeKey:e=>ke(n.props.nodeKey,e.data),getNodeClass:t=>{const o=e.props.class;if(!o)return{};let n;if(E(o)){const{data:e}=t;n=o(e,t)}else n=o;return w(n)?{[n]:!0}:n},handleSelectChange:u,handleClick:()=>{const t=n.store.value;t.setCurrentNode(e.node),n.ctx.emit("current-change",t.currentNode?t.currentNode.data:null,t.currentNode),n.currentNode.value=e.node,n.props.expandOnClickNode&&f(),n.props.checkOnClickNode&&!e.node.disabled&&m(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,c)},handleContextMenu:t=>{n.instance.vnode.props.onNodeContextmenu&&(t.stopPropagation(),t.preventDefault()),n.ctx.emit("node-contextmenu",t,e.node.data,e.node,c)},handleExpandIconClick:f,handleCheckChange:m,handleChildNodeExpand:(e,t,d)=>{o(t),n.ctx.emit("node-expand",e,t,d)},handleDragStart:t=>{n.props.draggable&&l.treeNodeDragStart({event:t,treeNode:e})},handleDragOver:t=>{n.props.draggable&&(l.treeNodeDragOver({event:t,treeNode:{$el:i.value,node:e.node}}),t.preventDefault())},handleDrop:e=>{e.preventDefault()},handleDragEnd:e=>{n.props.draggable&&l.treeNodeDragEnd(e)},CaretRight:ge}}});const Se=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],Oe=["aria-expanded"];_e.render=function(e,t,o,n,d,r){const s=K("el-icon"),h=K("el-checkbox"),u=K("loading"),p=K("node-content"),f=K("el-tree-node"),g=K("el-collapse-transition");return _((i(),l("div",{ref:"node$",class:B(["el-tree-node",a({"is-expanded":e.expanded,"is-current":e.node.isCurrent,"is-hidden":!e.node.visible,"is-focusable":!e.node.disabled,"is-checked":!e.node.disabled&&e.node.checked},e.getNodeClass(e.node))]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=L(((...t)=>e.handleClick&&e.handleClick(...t)),["stop"])),onContextmenu:t[2]||(t[2]=(...t)=>e.handleContextMenu&&e.handleContextMenu(...t)),onDragstart:t[3]||(t[3]=L(((...t)=>e.handleDragStart&&e.handleDragStart(...t)),["stop"])),onDragover:t[4]||(t[4]=L(((...t)=>e.handleDragOver&&e.handleDragOver(...t)),["stop"])),onDragend:t[5]||(t[5]=L(((...t)=>e.handleDragEnd&&e.handleDragEnd(...t)),["stop"])),onDrop:t[6]||(t[6]=L(((...t)=>e.handleDrop&&e.handleDrop(...t)),["stop"]))},[c("div",{class:"el-tree-node__content",style:j({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(i(),O(s,{key:0,class:B([{"is-leaf":e.node.isLeaf,expanded:!e.node.isLeaf&&e.expanded},"el-tree-node__expand-icon"]),onClick:L(e.handleExpandIconClick,["stop"])},{default:A((()=>[(i(),O(T(e.tree.props.icon||e.CaretRight)))])),_:1},8,["class","onClick"])):$("v-if",!0),e.showCheckbox?(i(),O(h,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=L((()=>{}),["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):$("v-if",!0),e.node.loading?(i(),O(s,{key:2,class:"el-tree-node__loading-icon is-loading"},{default:A((()=>[I(u)])),_:1})):$("v-if",!0),I(p,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],4),I(g,null,{default:A((()=>[!e.renderAfterExpand||e.childNodeRendered?_((i(),l("div",{key:0,class:"el-tree-node__children",role:"group","aria-expanded":e.expanded},[(i(!0),l(M,null,q(e.node.childNodes,(t=>(i(),O(f,{key:e.getNodeKey(t),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:t,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","props","onNodeExpand"])))),128))],8,Oe)),[[S,e.expanded]]):$("v-if",!0)])),_:1})],42,Se)),[[S,e.node.visible]])},_e.__file="packages/components/tree/src/tree-node.vue";var Ae=r({name:"ElTree",components:{ElTreeNode:_e},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:[String,Object]},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=J(),n=y(new De({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));n.value.initialize();const d=y(n.value.root),a=y(null),r=y(null),s=y(null),{broadcastExpanded:i}=we(e),{dragState:l}=function({props:e,ctx:t,el$:o,dropIndicator$:n,store:d}){const a=y({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return g(Ke,{treeNodeDragStart:({event:o,treeNode:n})=>{if("function"==typeof e.allowDrag&&!e.allowDrag(n.node))return o.preventDefault(),!1;o.dataTransfer.effectAllowed="move";try{o.dataTransfer.setData("text/plain","")}catch(d){}a.value.draggingNode=n,t.emit("node-drag-start",n.node,o)},treeNodeDragOver:({event:d,treeNode:r})=>{const s=r,i=a.value.dropNode;i&&i!==s&&m(i.$el,"is-drop-inner");const l=a.value.draggingNode;if(!l||!s)return;let c=!0,h=!0,u=!0,p=!0;"function"==typeof e.allowDrop&&(c=e.allowDrop(l.node,s.node,"prev"),p=h=e.allowDrop(l.node,s.node,"inner"),u=e.allowDrop(l.node,s.node,"next")),d.dataTransfer.dropEffect=h?"move":"none",(c||h||u)&&i!==s&&(i&&t.emit("node-drag-leave",l.node,i.node,d),t.emit("node-drag-enter",l.node,s.node,d)),(c||h||u)&&(a.value.dropNode=s),s.node.nextSibling===l.node&&(u=!1),s.node.previousSibling===l.node&&(c=!1),s.node.contains(l.node,!1)&&(h=!1),(l.node===s.node||l.node.contains(s.node))&&(c=!1,h=!1,u=!1);const f=s.$el.getBoundingClientRect(),g=o.value.getBoundingClientRect();let y;const v=c?h?.25:u?.45:1:-1,N=u?h?.75:c?.55:0:1;let C=-9999;const x=d.clientY-f.top;y=x<f.height*v?"before":x>f.height*N?"after":h?"inner":"none";const b=s.$el.querySelector(".el-tree-node__expand-icon").getBoundingClientRect(),D=n.value;"before"===y?C=b.top-g.top:"after"===y&&(C=b.bottom-g.top),D.style.top=`${C}px`,D.style.left=b.right-g.left+"px","inner"===y?k(s.$el,"is-drop-inner"):m(s.$el,"is-drop-inner"),a.value.showDropIndicator="before"===y||"after"===y,a.value.allowDrop=a.value.showDropIndicator||p,a.value.dropType=y,t.emit("node-drag-over",l.node,s.node,d)},treeNodeDragEnd:e=>{const{draggingNode:o,dropType:n,dropNode:r}=a.value;if(e.preventDefault(),e.dataTransfer.dropEffect="move",o&&r){const a={data:o.node.data};"none"!==n&&o.node.remove(),"before"===n?r.node.parent.insertBefore(a,r.node):"after"===n?r.node.parent.insertAfter(a,r.node):"inner"===n&&r.node.insertChild(a),"none"!==n&&d.value.registerNode(a),m(r.$el,"is-drop-inner"),t.emit("node-drag-end",o.node,r.node,n,e),"none"!==n&&t.emit("node-drop",o.node,r.node,n,e)}o&&!r&&t.emit("node-drag-end",o.node,null,n,e),a.value.showDropIndicator=!1,a.value.draggingNode=null,a.value.dropNode=null,a.value.allowDrop=!0}}),{dragState:a}}({props:e,ctx:t,el$:r,dropIndicator$:s,store:n});!function({el$:e},t){const o=z([]),n=z([]);P((()=>{a(),V(e.value,"keydown",d)})),F((()=>{R(e.value,"keydown",d)})),H((()=>{o.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))})),x(n,(e=>{e.forEach((e=>{e.setAttribute("tabindex","-1")}))}));const d=n=>{const d=n.target;if(-1===d.className.indexOf("el-tree-node"))return;const a=n.code;o.value=Array.from(e.value.querySelectorAll(".is-focusable[role=treeitem]"));const r=o.value.indexOf(d);let s;if([U.up,U.down].indexOf(a)>-1){if(n.preventDefault(),a===U.up){s=-1===r?0:0!==r?r-1:o.value.length-1;const e=s;for(;!t.value.getNode(o.value[s].dataset.key).canFocus;){if(s--,s===e){s=-1;break}s<0&&(s=o.value.length-1)}}else{s=-1===r?0:r<o.value.length-1?r+1:0;const e=s;for(;!t.value.getNode(o.value[s].dataset.key).canFocus;){if(s++,s===e){s=-1;break}s>=o.value.length&&(s=0)}}-1!==s&&o.value[s].focus()}[U.left,U.right].indexOf(a)>-1&&(n.preventDefault(),d.click());const i=d.querySelector('[type="checkbox"]');[U.enter,U.space].indexOf(a)>-1&&i&&(n.preventDefault(),i.click())},a=()=>{var t;o.value=Array.from(e.value.querySelectorAll(".is-focusable[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const d=e.value.querySelectorAll(".is-checked[role=treeitem]");d.length?d[0].setAttribute("tabindex","0"):null==(t=o.value[0])||t.setAttribute("tabindex","0")}}({el$:r},n);const c=W((()=>{const{childNodes:e}=d.value;return!e||0===e.length||e.every((({visible:e})=>!e))}));x((()=>e.defaultCheckedKeys),(e=>{n.value.setDefaultCheckedKey(e)})),x((()=>e.defaultExpandedKeys),(e=>{n.value.defaultExpandedKeys=e,n.value.setDefaultExpandedKeys(e)})),x((()=>e.data),(e=>{n.value.setData(e)}),{deep:!0}),x((()=>e.checkStrictly),(e=>{n.value.checkStrictly=e}));const h=()=>{const e=n.value.getCurrentNode();return e?e.data:null};return g("RootTree",{ctx:t,props:e,store:n,root:d,currentNode:a,instance:D()}),{store:n,root:d,currentNode:a,dragState:l,el$:r,dropIndicator$:s,isEmpty:c,filter:t=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");n.value.filter(t)},getNodeKey:t=>ke(e.nodeKey,t.data),getNodePath:t=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const o=n.value.getNode(t);if(!o)return[];const a=[o.data];let r=o.parent;for(;r&&r!==d.value;)a.push(r.data),r=r.parent;return a.reverse()},getCheckedNodes:(e,t)=>n.value.getCheckedNodes(e,t),getCheckedKeys:e=>n.value.getCheckedKeys(e),getCurrentNode:h,getCurrentKey:()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const t=h();return t?t[e.nodeKey]:null},setCheckedNodes:(t,o)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");n.value.setCheckedNodes(t,o)},setCheckedKeys:(t,o)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");n.value.setCheckedKeys(t,o)},setChecked:(e,t,o)=>{n.value.setChecked(e,t,o)},getHalfCheckedNodes:()=>n.value.getHalfCheckedNodes(),getHalfCheckedKeys:()=>n.value.getHalfCheckedKeys(),setCurrentNode:(t,o=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");n.value.setUserCurrentNode(t,o)},setCurrentKey:(t,o=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");n.value.setCurrentNodeKey(t,o)},t:o,getNode:e=>n.value.getNode(e),remove:e=>{n.value.remove(e)},append:(e,t)=>{n.value.append(e,t)},insertBefore:(e,t)=>{n.value.insertBefore(e,t)},insertAfter:(e,t)=>{n.value.insertAfter(e,t)},handleNodeExpand:(e,o,n)=>{i(o),t.emit("node-expand",e,o,n)},updateKeyChildren:(t,o)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");n.value.updateChildren(t,o)}}}});const Te={key:0,class:"el-tree__empty-block"},Be={class:"el-tree__empty-text"},Le={ref:"dropIndicator$",class:"el-tree__drop-indicator"};Ae.render=function(e,t,o,n,d,a){var r;const s=K("el-tree-node");return i(),l("div",{ref:"el$",class:B(["el-tree",{"el-tree--highlight-current":e.highlightCurrent,"is-dragging":!!e.dragState.draggingNode,"is-drop-not-allow":!e.dragState.allowDrop,"is-drop-inner":"inner"===e.dragState.dropType}]),role:"tree"},[(i(!0),l(M,null,q(e.root.childNodes,(t=>(i(),O(s,{key:e.getNodeKey(t),node:t,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"])))),128)),e.isEmpty?(i(),l("div",Te,[c("span",Be,G(null!=(r=e.emptyText)?r:e.t("el.tree.emptyText")),1)])):$("v-if",!0),_(c("div",Le,null,512),[[S,e.dragState.showDropIndicator]])],2)},Ae.__file="packages/components/tree/src/tree.vue",Ae.install=e=>{e.component(Ae.name,Ae)};const $e=Ae;const Ie=[{title:"首页",permission:"system:index"},{title:"用户管理",permission:"system:user"},{title:"门店管理",permission:"system:store"},{title:"商品管理",permission:"system:goods",children:[{title:"商品种类",permission:"system:goods:goodsCategory"},{title:"商品信息",permission:"system:goods:goodsInfo",children:[{title:"添加商品",permission:"system:goods:goodsInfo:add"},{title:"修改商品",permission:"system:goods:goodsInfo:update"}]}]},{title:"订单管理",permission:"system:order",children:[{title:"订单查询",permission:"system:order:orderInfo"},{title:"订单管理",permission:"system:order:orderManage"}]},{title:"系统管理",permission:"system:admin",children:[{title:"系统配置",permission:"system:admin:config"},{title:"定时任务",permission:"system:admin:timingTask"},{title:"管理员管理",permission:"system:admin:sysUser"},{title:"角色管理",permission:"system:admin:role"}]}],je={style:{margin:"5px 10px","text-align":"left"}},Me=X("添加角色"),qe=X("重置"),ze=X("确定"),Pe=X("清空"),Ve=X("确认"),Fe={style:{margin:"5px 10px","text-align":"left"}},Re=X(" 授权 "),He=X("编辑"),Ue=X(" 删除 "),Je=r({setup(e){const{proxy:t}=D(),o=u({roles:[],formTitle:"",dialogVisible:!1,formData:{id:0,name:"",description:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],description:[]},showSetPermissionDialog:!1,permissionTree:Ie,defaultProps:{id:"title",label:"title",children:"children"},permissions:[]}),n=y();P((()=>{d()}));const d=()=>{te().then((e=>{o.roles=e.data}))},a=()=>{o.dialogVisible=!0,o.formTitle="添加角色",r()},r=()=>{o.formData={id:0,name:"",description:""}},s=()=>{"添加角色"===o.formTitle?ae(o.formData).then((()=>{null==t||t.$Notify.success("添加角色成功"),d(),o.dialogVisible=!1})):"更新角色"===o.formTitle&&re(o.formData).then((()=>{null==t||t.$Notify.success("更新角色成功"),d(),o.dialogVisible=!1}))},h=()=>{n.value.setCheckedKeys([],!1)},p=()=>{let e=n.value.getCheckedNodes(!1,!1),d=[];e.forEach((e=>{e.permission&&d.push(e.permission)}));let a={roleId:o.formData.id,permissions:d};le(a).then((()=>{null==t||t.$Notify.success("修改成功"),o.showSetPermissionDialog=!1}))};return(e,u)=>{const f=Y,g=Z,y=ce,m=he,k=oe,v=$e,N=ne,C=de;return i(),l("div",null,[c("div",je,[I(f,{type:"primary",onClick:a},{default:A((()=>[Me])),_:1})]),I(k,{title:Q(o).formTitle,modelValue:Q(o).dialogVisible,"onUpdate:modelValue":u[2]||(u[2]=e=>Q(o).dialogVisible=e)},{default:A((()=>[I(m,{ref:"elForm",model:Q(o).formData,rules:Q(o).rules,"label-width":"100px"},{default:A((()=>[I(y,{label:"角色名称",prop:"name"},{default:A((()=>[I(g,{modelValue:Q(o).formData.name,"onUpdate:modelValue":u[0]||(u[0]=e=>Q(o).formData.name=e),placeholder:"请输入角色名称",maxlength:20,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),I(y,{label:"描述"},{default:A((()=>[I(g,{modelValue:Q(o).formData.description,"onUpdate:modelValue":u[1]||(u[1]=e=>Q(o).formData.description=e),placeholder:"请输入角色描述",maxlength:40,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),I(y,null,{default:A((()=>[I(f,{onClick:r},{default:A((()=>[qe])),_:1}),I(f,{type:"primary",onClick:s},{default:A((()=>[ze])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"]),I(k,{title:"角色授权",modelValue:Q(o).showSetPermissionDialog,"onUpdate:modelValue":u[3]||(u[3]=e=>Q(o).showSetPermissionDialog=e),"destroy-on-close":""},{default:A((()=>[I(m,null,{default:A((()=>[I(y,null,{default:A((()=>[I(v,{data:Q(o).permissionTree,"show-checkbox":"",props:Q(o).defaultProps,"node-key":"permission","default-checked-keys":Q(o).permissions,ref_key:"permissionRef",ref:n},null,8,["data","props","default-checked-keys"])])),_:1}),I(y,null,{default:A((()=>[I(f,{onClick:h},{default:A((()=>[Pe])),_:1}),I(f,{type:"primary",onClick:p},{default:A((()=>[Ve])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),c("div",Fe,[I(C,{data:Q(o).roles},{default:A((()=>[I(N,{prop:"name",label:"角色名称"}),I(N,{prop:"description",label:"描述"}),I(N,{label:"操作"},{default:A((e=>[I(f,{type:"text",onClick:t=>{return n=e.row,o.permissions=[],o.formData=JSON.parse(JSON.stringify(n)),o.showSetPermissionDialog=!0,void ie(n.id).then((e=>{o.permissions=e.data}));var n}},{default:A((()=>[Re])),_:2},1032,["onClick"]),I(f,{type:"text",onClick:t=>{return n=e.row,o.formData=JSON.parse(JSON.stringify(n)),o.dialogVisible=!0,void(o.formTitle="更新角色");var n}},{default:A((()=>[He])),_:2},1032,["onClick"]),I(f,{type:"text",onClick:o=>{return n=e.row.id,void(null==t||t.$Confirm("确认要删除角色吗?").then((()=>{se([n]).then((()=>{null==t||t.$Notify.success("删除成功"),d()}))})).catch((()=>{})));var n}},{default:A((()=>[Ue])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])])}}});export{Je as default};
